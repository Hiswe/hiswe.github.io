<% if (config.disqus_shortname){ %>
<script type="text/javascript">
var disqus_shortname = '<%= config.disqus_shortname %>';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/<% if (page.comments){ %>embed.js<% } else { %>count.js<% } %>';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>
<% } %>
<script>
  (function(){
    // https://developers.google.com/web/updates/2017/09/sticky-headers
    // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API
    if (!'IntersectionObserver' in window) return
    var toc = document.querySelector('.js-toc')
    if (!toc) return
    var tocSentinel = document.createElement('div')
    var stuckClass = 'is-stuck'
    tocSentinel.classList.add('article-long__toc-sentinel')
    toc.insertBefore( tocSentinel, toc.firstChild )
    var oberverCb = function(entries) {
      const tocSentinelEntry = entries[0]
      if ( tocSentinelEntry.intersectionRatio === 0 )  {
        toc.classList.add( stuckClass )
      } else {
        toc.classList.remove( stuckClass )
      }
    }
    var observer = new IntersectionObserver(oberverCb, {
      threshold: 1,
    })
    observer.observe( tocSentinel)
  })()
</script>
